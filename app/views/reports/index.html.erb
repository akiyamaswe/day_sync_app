<h1><%= t('views.common.title_index', name: i18n_pluralize(Report.model_name.human)) %></h1>

<div class="search-panel-container">
  <button type="button" class="search-panel-toggle">
    <span class="toggle-icon">â–¶</span>
    <%= t('views.common.detailed_search') %>
  </button>

  <div class="search-panel">
    <div class="search-compact">
      <%= search_form_for @q, html: { data: { turbo_frame: "reports-results" } } do |f| %>
        <div class="search-grid">
          <div class="search-top-fields">
            <div class="search-field">
              <%= f.label :user_id_eq, User.model_name.human %>
              <%= f.collection_select :user_id_eq,
                  User.all,
                  :id,
                  ->(user) { user.name.presence || user.email },
                  { include_blank: t('views.common.please_select') }
              %>
            </div>

            <div class="search-field">
              <%= f.label :title_cont, Report.human_attribute_name(:title) %>
              <%= f.text_field :title_cont %>
            </div>

            <div class="search-field">
              <%= f.label :content_cont, Report.human_attribute_name(:content) %>
              <%= f.text_field :content_cont %>
            </div>
          </div>

          <div class="search-date-fields">
            <div class="search-field">
              <%= f.label :created_at_gteq, t('views.common.date_range_start') %>
              <%= f.date_field :created_at_gteq %>
            </div>

            <div class="search-field">
              <%= f.label :created_at_lteq, t('views.common.date_range_end') %>
              <%= f.date_field :created_at_lteq %>
            </div>
          </div>

          <div class="search-actions">
            <%= f.submit t('views.common.search'), class: 'search-button search-submit' %>
            <%= link_to t('views.common.clear'), reports_path, 
                class: 'search-button search-clear',
                data: { turbo_frame: "reports-results" } %>
          </div>
        </div>
      <% end %>
    </div>
  </div>
</div>

<%= turbo_frame_tag "reports-results" do %>
  <div id="reports" class="index-items">
    <% @reports.each do |report| %>
      <div class="index-item">
        <%= render report %>
        <p>
          <%= link_to t('views.common.show', name: Report.model_name.human.downcase), report %>
        </p>
      </div>
    <% end %>
  </div>

  <%= paginate @reports %>
<% end %>

<nav class="page-nav">
  <%= link_to t('views.common.new', name: Report.model_name.human.downcase), new_report_path %>
</nav>
